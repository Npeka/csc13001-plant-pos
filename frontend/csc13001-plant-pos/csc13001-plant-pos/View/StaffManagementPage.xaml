<Page
    x:Class="csc13001_plant_pos.View.StaffManagementPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="using:CommunityToolkit.WinUI.UI.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="using:csc13001_plant_pos.View"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ui="using:csc13001_plant_pos.View.UI"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}"
    mc:Ignorable="d">

    <Grid
        Padding="24"
        RowSpacing="12">
        <Grid.RowDefinitions>
            <RowDefinition
                Height="Auto" />
            <RowDefinition
                Height="Auto" />
            <RowDefinition
                Height="Auto" />
            <RowDefinition
                Height="*" />
        </Grid.RowDefinitions>

        <ui:PageTitle
            Title="Quản lý nhân viên"
            Grid.Column="0" />

        <Grid
            Grid.Row="1"
            Margin="0,0,0,16">
            <Grid.RowDefinitions>
                <RowDefinition
                    Height="Auto" />
                <RowDefinition
                    Height="Auto" />
            </Grid.RowDefinitions>

            <Grid
                Grid.Row="0"
                Margin="0,0,0,12">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition
                        Width="*" />
                    <ColumnDefinition
                        Width="Auto" />
                </Grid.ColumnDefinitions>

                <TextBox
                    x:Name="SearchBox"
                    Grid.Column="0"
                    PlaceholderText="Tìm kiếm theo tên hoặc ID nhân viên..."
                    Text="{x:Bind ViewModel.SearchQuery, Mode=TwoWay}"
                    TextChanged="{x:Bind ViewModel.SearchBox_TextChanged, Mode=OneWay}">
                    <TextBox.Resources>
                        <ResourceDictionary>
                            <ResourceDictionary.ThemeDictionaries>
                                <ResourceDictionary
                                    x:Key="Light">
                                    <SolidColorBrush
                                        x:Key="TextControlBackgroundFocused"
                                        Color="#F5F5F5" />
                                </ResourceDictionary>
                            </ResourceDictionary.ThemeDictionaries>
                        </ResourceDictionary>
                    </TextBox.Resources>
                </TextBox>

                <Button
                    Grid.Column="1"
                    Margin="8,0,0,0"
                    CornerRadius="4">
                    <StackPanel
                        Orientation="Horizontal">
                        <FontIcon
                            Margin="0,0,5,0"
                            VerticalAlignment="Center"
                            Glyph="&#xE710;" />
                        <TextBlock
                            VerticalAlignment="Center"
                            Text="Thêm nhân viên" />
                    </StackPanel>
                </Button>

            </Grid>

            <Grid
                Grid.Row="1"
                Padding="16"
                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                BorderThickness="1"
                CornerRadius="8">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition
                        Width="*" />
                    <ColumnDefinition
                        Width="*" />
                    <ColumnDefinition
                        Width="Auto" />
                </Grid.ColumnDefinitions>

                <!--  Bộ lọc ngày  -->
                <StackPanel
                    Grid.Column="0"
                    Margin="0,0,8,0">
                    <TextBlock
                        Margin="0,0,0,4"
                        FontSize="12"
                        Opacity="0.8"
                        Text="Ngày bắt đầu làm việc" />
                    <CalendarDatePicker
                        x:Name="DateFilter"
                        HorizontalAlignment="Stretch"
                        DateChanged="{x:Bind ViewModel.DateFilter_DateChanged, Mode=Oneway}" />
                </StackPanel>

                <!--  Bộ lọc vị trí  -->
                <StackPanel
                    Grid.Column="1"
                    Margin="8,0,8,0">
                    <TextBlock
                        Margin="0,0,0,4"
                        FontSize="12"
                        Opacity="0.8"
                        Text="Trạng thái" />
                    <ComboBox
                        x:Name="PositionFilter"
                        HorizontalAlignment="Stretch">
                        <ComboBoxItem
                            Content="Tất cả" />
                        <ComboBoxItem
                            Content="Working" />
                        <ComboBoxItem
                            Content="Resigned" />
                        <ComboBoxItem
                            Content="OnLeave" />
                    </ComboBox>
                </StackPanel>

                <!--  Nút Reset  -->
                <Button
                    Grid.Column="2"
                    Margin="8,0,0,0"
                    VerticalAlignment="Bottom"
                    Background="Transparent"
                    BorderBrush="#D13438"
                    BorderThickness="1"
                    Click="{x:Bind ViewModel.ResetFilters, Mode=OneWay}"
                    Content="Đặt lại bộ lọc"
                    Foreground="#D13438" />
            </Grid>
        </Grid>

        <Grid
            Grid.Row="2"
            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
            BorderThickness="1"
            CornerRadius="8">

            <Grid.RowDefinitions>
                <RowDefinition
                    Height="Auto" />
                <RowDefinition
                    Height="*" />
            </Grid.RowDefinitions>

            <!--  Header cho DataGrid  -->
            <Grid
                Grid.Row="0"
                Padding="16,12"
                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                BorderThickness="0,0,0,1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition
                        Width="*" />
                    <ColumnDefinition
                        Width="Auto" />
                </Grid.ColumnDefinitions>

                <TextBlock
                    VerticalAlignment="Center"
                    FontWeight="SemiBold"
                    Text="Danh sách nhân viên" />

                <TextBlock
                    x:Name="EmployeeCount"
                    Grid.Column="1"
                    VerticalAlignment="Center"
                    Opacity="0.7"
                    Text="{x:Bind ViewModel.FilteredStaffCount, Mode=OneWay}" />

            </Grid>

            <!--  DataGrid  -->
            <controls:DataGrid
                x:Name="EmployeesGrid"
                Grid.Row="1"
                Margin="0"
                Padding="16"
                AutoGenerateColumns="False"
                CanUserReorderColumns="False"
                GridLinesVisibility="Horizontal"
                HeadersVisibility="Column"
                ItemsSource="{Binding ViewModel.productList}">
                <controls:DataGrid.Resources>
                    <SolidColorBrush
                        x:Key="DataGridColumnHeaderBackgroundColor"
                        Color="Transparent" />
                    <SolidColorBrush
                        x:Key="DataGridColumnHeaderForegroundColor"
                        Color="#666666" />
                    <SolidColorBrush
                        x:Key="DataGridGridLinesBrush"
                        Color="#E0E0E0" />
                    <Thickness
                        x:Key="DataGridRowGroupHeaderMargin">0</Thickness>
                </controls:DataGrid.Resources>
                <controls:DataGrid.Columns>
                    <controls:DataGridTextColumn
                        Width="70"
                        Binding="{Binding UserId}"
                        Header="ID" />
                    <controls:DataGridTextColumn
                        Width="*"
                        Binding="{Binding Fullname}"
                        Header="Họ Tên" />
                    <controls:DataGridTextColumn
                        Width="150"
                        Binding="{Binding Phone}"
                        Header="Số điện thoại" />
                    <controls:DataGridTextColumn
                        Width="130"
                        Binding="{Binding StartDate}"
                        Header="Ngày bắt đầu" />
                    <controls:DataGridTextColumn
                        Width="180"
                        Binding="{Binding Status}"
                        Header="Trạng thái" />
                    <controls:DataGridTemplateColumn
                        Width="200"
                        Header="Thao tác">
                        <controls:DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel
                                    HorizontalAlignment="Center"
                                    Orientation="Horizontal">
                                    <Button
                                        Padding="6,4"
                                        Background="#E3F2FD"
                                        CornerRadius="4"
                                        Foreground="#1976D2"
                                        Tag="{Binding}">
                                        <StackPanel
                                            Orientation="Horizontal">
                                            <FontIcon
                                                Margin="0,0,5,0"
                                                FontFamily="Segoe MDL2 Assets"
                                                Glyph="&#xE70F;" />
                                            <TextBlock
                                                VerticalAlignment="Center"
                                                Text="Sửa" />
                                        </StackPanel>
                                    </Button>
                                    <Button
                                        Padding="6,4"
                                        Background="#FFEBEE"
                                        CornerRadius="4"
                                        Foreground="#C62828"
                                        Tag="{Binding}">
                                        <StackPanel
                                            Orientation="Horizontal">
                                            <FontIcon
                                                Margin="0,0,5,0"
                                                FontFamily="Segoe MDL2 Assets"
                                                Glyph="&#xE74D;" />
                                            <TextBlock
                                                VerticalAlignment="Center"
                                                Text="Xóa" />
                                        </StackPanel>
                                    </Button>
                                </StackPanel>
                            </DataTemplate>
                        </controls:DataGridTemplateColumn.CellTemplate>
                    </controls:DataGridTemplateColumn>
                </controls:DataGrid.Columns>
            </controls:DataGrid>
        </Grid>
    </Grid>
</Page>
